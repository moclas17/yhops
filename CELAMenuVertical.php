<?php/*** Empresa: 3e de mexico SA de CV* Programador: Eumir Esteban Salgado Lampart/Vazquez Arellanes Mijail.* Fecha: 22/11/2013* Descripción: Version 3.0 de menu Horizontal. * Comentarios: Genera un menú vertical y el encabezado a partir de una serie de menus registrados * en la base de datos.**/$categoriaFormularioActual=array();$consultaCategoriaFormularioActual="SELECT Categor_ia FROM CelaMen_u WHERE Referencia='".$FomularioRuta."'";$resultadoCategoriaFormularioActual=$Conexion->query($consultaCategoriaFormularioActual);while($registroCategoriaFormularioActual=$resultadoCategoriaFormularioActual->fetch_assoc()){	$categoriaFormularioActual[]=$registroCategoriaFormularioActual['Categor_ia'];}$consultaMenu="SELECT m.Etiqueta as MenuEtiqueta, m.idMenu as idMenu, m.Referencia as ReferenciaMenu, m.Categor_ia as MenuCategoria, i.NombreDelIcono as MenuIcono, m.Descripci_on as MenuDescripcion, m.Prioridad as MenuPrioridad, m.TipoDeElemento as MenuTipo, mc.Etiqueta as CategoriaEtiqueta, (select NombreDelIcono from CelaIcono where CelaIcono.idIcono=mc.Icono ) as CategoriaIcono, mc.Descripci_on as CategoriaDescripcion, mc.Prioridad as CategoriaPrioridad, mc.Referencia as CategoriaReferencia FROM CelaMen_u m INNER JOIN CelaMen_u mc ON (m.Categor_ia = mc.idMenu) INNER JOIN CelaIcono i ON (m.Icono=i.idIcono) WHERE m.idMenu IN (select Elemento from CelaPrivilegios where RolDeUsuario=".$_SESSION['CELA_CveRol'.$_SESSION['CELA_Aleatorio']]." AND Tabla=1) AND m.TipoDeElemento=1 AND m.Orientaci_on=1 ORDER BY  mc.Prioridad, m.Categor_ia, m.Prioridad";$resultadoMenu=$Conexion->query($consultaMenu);$registrosMenu=$resultadoMenu->num_rows;if($registrosMenu>0){	$iconBg= array('bg-danger','bg-info','bg-success','bg-warning','bg-primary','bg-orange','bg-violet','g-dark','bg-bright','bg-reverse','bg-facebook','bg-twitter','bg-google-plus');?>	<div id="nav-container" class="col-md-2 sidebar">		<?php			$imagen=ObtenValor("SELECT Valor FROM CelaConfiguraci_on WHERE Nombre='Logotipo'","Valor");			if($imagen!="" || $imagen!=NULL){		?>			<div class="row text-center" >				<a href="Escritorio.php">					<img width="175px" alt="SISTEMA <?php print isset($_SESSION['CELA_NombreSistema'.$_SESSION['CELA_Aleatorio']])?$_SESSION['CELA_CveRol'.$_SESSION['CELA_Aleatorio']]:strtoupper(ObtenValor("SELECT Valor FROM CelaConfiguraci_on WHERE Nombre='NombreSistema'","Valor"));?>"  class="img-polaroid" src="<?php print $imagen; ?>" class="img-responsive"/>				</a>			</div>		<?php			}		?>		<ul id="nav" class="nav nav-sidebar ul" data-intro="Men&uacute; Principal" data-position="top">	<?php		$categoriaDeMenu='';		$contadorCategoria=0;		$estiloCategoria=0;		$registroMenu=$resultadoMenu->fetch_assoc();		do{	?>			<li <?php print in_array($registroMenu['MenuCategoria'],$categoriaFormularioActual)?'class="open active"':''; ?>>				<a href="<?php print $registroMenu['CategoriaReferencia']; ?>" class="menuOption" title="<?php print $registroMenu['CategoriaDescripcion']; ?>">					<i class="<?php print $registroMenu['CategoriaIcono']; ?>">						<span class="icon-bg <?php print $iconBg[$estiloCategoria]; ?>"></span>					</i>					<span><?php print $registroMenu['CategoriaEtiqueta']; ?></span>				</a>		<?php			if($registroMenu['CategoriaEtiqueta']!=$registroMenu['MenuEtiqueta'] && $registroMenu['CategoriaReferencia']!=$registroMenu['ReferenciaMenu']){				$categoriaDeMenu=$registroMenu['MenuCategoria'];		?>				<ul style="display: block;">		<?php				do{					if($registroMenu['MenuTipo']==1){		?>					<li <?php print $FomularioRuta==$registroMenu['ReferenciaMenu']?'class="active"':''; ?>>						<a href="<?php print $registroMenu['ReferenciaMenu']; ?>" title="<?php print $registroMenu['MenuDescripcion']; ?>">							<i class="<?php print $registroMenu['MenuIcono']; ?>"></i>							<span><?php print $registroMenu['MenuEtiqueta']; ?></span>						</a>					</li>		<?php					}					$registroMenu=$resultadoMenu->fetch_assoc();					$contadorCategoria++;				}while($categoriaDeMenu==$registroMenu['MenuCategoria']);		?>				</ul>				<i class="fa <?php print in_array($categoriaDeMenu,$categoriaFormularioActual)?' fa-caret-up':' fa-caret-right'; ?> icon-has-ul"></i>						<?php			}			else{				$registroMenu=$resultadoMenu->fetch_assoc();				$contadorCategoria++;			}		?>			</li>	<?php			$estiloCategoria++;		}while($contadorCategoria<$registrosMenu);	?>			</ul>	</div><?php}?>	<noscript>		<div class="alert alert-block col-md-10">			<h4 class="alert-heading">Advertencia</h4>			<p>				Necesitas tener <a href="http://en.wikipedia.org/wiki/JavaScript" target="_blank">JavaScript</a> habilitado para usar este sitio.			</p>		</div>	</noscript><!-- Menú Vertical Lado izquierdo      -->